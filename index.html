<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Void's Challenge</title>
    <style>
        /* --- Basic Reset and Shared Styles --- */
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #111, #333, #111);
            color: #eee;
            overflow: hidden; /* Hide scrollbars during gameplay */
        }

        #container {
            position: relative;  /* For absolute positioning of game elements */
            width: 100%;
            height: 100%;
            overflow: hidden; /* Critical for keeping things within bounds */
        }

        /* --- "You Win" Message Styles --- */
        #win-message {
            position: fixed; /* Stays in a fixed position */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 180, 0, 0.9);
            color: white;
            padding: 30px 50px;
            font-size: 3em;
            border-radius: 15px;
            z-index: 2000; /* High z-index, appears on top */
            display: none; /* Hidden initially */
            text-align: center;
             box-shadow: 0 0 20px rgba(0, 255, 0, 0.8); /* Glow effect */
             opacity: 0; /*  Start hidden for fade-in */
            transition: opacity 0.5s ease; /* Smooth fade-in */
        }

           #win-message.show {
             display: block;
             opacity: 1;
             animation: winPulse 2s infinite alternate; /*  Subtle pulse */
        }

        @keyframes winPulse {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(-50%, -50%) scale(1.05); }
        }

         /* --- Game Level Styles --- */
        #game-level {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none; /* Hidden initially, shown after "winning" */
             background: linear-gradient(to bottom, #222, #444); /* Darker background */
        }

         #player {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #007bff; /* Bright blue */
            border-radius: 50%; /* Circle */
            left: 50px; /* Starting position */
            top: 50px;
            transition: top 0.1s linear, left 0.1s linear; /* Smooth movement */
            z-index: 100; /* Above obstacles, below goal */
        }

         .obstacle {
            position: absolute;
             background: linear-gradient(to right, #800000, #ff0000); /* Red gradient */
             border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
            z-index: 50; /* Below player and goal */

        }


        #goal {
            position: absolute;
            width: 50px;
            height: 50px;
             background: linear-gradient(to bottom, #00ff00, #008000); /* Green gradient */
            border-radius: 50%;
            right: 50px; /* Position at the right edge */
            bottom: 50px;
             z-index: 150;  /*  Above the player, so it can be "collected" */
             animation: goalSpin 5s linear infinite;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.7); /* Glowing effect */
        }

        @keyframes goalSpin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* --- Hidden Area --- */
        #hidden-area {
             position: absolute;
            width: 100px;
            height: 100px;
            background-color: rgba(255, 255, 255, 0.1); /* Semi-transparent */
             top: 200px; /*  Example position - change this */
             left: 350px;
            z-index: 200;
             /* Hidden by default, revealed on hover (see JS) */
            display: none;  /* Initially hidden */
            border-radius: 10px;
             transition: background-color 0.3s ease; /* Smooth transition */

        }

         #hidden-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
             font-size: 1.2em;
            text-align: center;
            display: none;  /* Hidden by default */
            opacity: 0; /* Start hidden */
             transition: opacity 0.3s ease; /* Smooth fade-in */
            pointer-events: none; /*  Don't block interaction with hidden area */
        }
        #hidden-area:hover #hidden-message {
            display: block; /* Show on hover */
            opacity: 1;

        }
           #hidden-area:hover {
            background-color: rgba(255, 255, 255, 0.3); /*  Brighter on hover */
             cursor: pointer; /*  Change cursor to indicate interactivity */
           }

        /* --- Styles from the "inescapable" part (condensed) --- */
        /* ... (Include the styles from the previous response, but remove
               the styles that are specific to the initial inescapable part,
               like the close button, floaters, distraction overlay, etc.
               Keep general styles like body, #container, animations, etc.) ... */

    </style>
</head>

<body>
    <div id="container">
        <!-- "You Win" message (initially hidden) -->
        <div id="win-message">You Escaped... But Can You Conquer the Void?</div>

        <!-- Game level elements -->
        <div id="game-level">
            <div id="player"></div>
            <div id="goal"></div>
            <div id="hidden-area">
                <div id="hidden-message">A secret!<br> (Maybe it helps?)</div>
            </div>
            <!-- Obstacles (added dynamically via JavaScript) -->
        </div>

        <!-- (No need for the close button, floaters, etc., from the previous part) -->
    </div>

    <script>
        // --- Variables from the "inescapable" part ---
        const container = document.getElementById('container');
        // ... (other variables like closeButton, distractionOverlay -  remove them)
        let floaterCount = 0; // Keep this, but it won't be used as much
        let maxFloaters = 30; //  Keep this, but it won't be used as much
        let closeAttempt = 0; // Keep, and reset to 0 when the game starts

        // --- NEW: Game Level Variables ---
        const gameLevel = document.getElementById('game-level');
        const player = document.getElementById('player');
        const goal = document.getElementById('goal');
        const winMessage = document.getElementById('win-message');
        const hiddenArea = document.getElementById('hidden-area');
        let playerX = 50; // Initial player position
        let playerY = 50;
        let obstacles = []; // Array to store obstacle data
        let gameRunning = false; // Flag to track if the game is active

        // --- Function to create obstacles ---
        function createObstacle(x, y, width, height) {
            const obstacle = document.createElement('div');
            obstacle.classList.add('obstacle');
            obstacle.style.left = `${x}px`;
            obstacle.style.top = `${y}px`;
            obstacle.style.width = `${width}px`;
            obstacle.style.height = `${height}px`;
            gameLevel.appendChild(obstacle);
            obstacles.push({ element: obstacle, x, y, width, height }); // Store for collision checks
        }


        // --- Function to start the game ---
        function startGame() {
            gameRunning = true;
            closeAttempt = 0; // Reset close attempts

            // --- 1. Hide the "inescapable" elements ---
            //  (Remove or hide any elements from the previous part that are no longer needed)
             // Example:  If you had a close button:
            // if (closeButton) { closeButton.style.display = 'none'; }

            // --- 2. Show the game level ---
            gameLevel.style.display = 'block';

            // --- 3. Reset player position ---
            playerX = 50;
            playerY = 50;
            player.style.left = `${playerX}px`;
            player.style.top = `${playerY}px`;

            // --- 4. Create obstacles ---
            //  (You can adjust the number, positions, and sizes of obstacles)
            obstacles = []; // Clear any existing obstacles
            createObstacle(150, 100, 200, 20); // Example obstacle
            createObstacle(300, 250, 30, 150);
            createObstacle(500, 100, 50, 300);
             createObstacle(100, 400, 250, 40); // Add more obstacles!
            createObstacle(600, 50, 80, 80);
            createObstacle(400, 350, 100, 20);

            // --- 5. Show the hidden area (if you want it to be visible at the start) ---
            hiddenArea.style.display = "block";
        }



        // --- Function to check for collisions ---
        function checkCollision() {
             const playerRect = player.getBoundingClientRect();

              // Check collision with goal
            const goalRect = goal.getBoundingClientRect();
             if (rectsOverlap(playerRect, goalRect)) {
                endGame(true); // Player wins!
                return; // Stop checking other collisions
             }

            // Check collision with obstacles
            for (const obstacle of obstacles) {
                const obstacleRect = obstacle.element.getBoundingClientRect();
                if (rectsOverlap(playerRect, obstacleRect)) {
                    endGame(false); // Player loses
                    return; // Stop checking other collisions
                }
            }

             // Check collision with hidden area
             const hiddenAreaRect = hiddenArea.getBoundingClientRect();
            if (rectsOverlap(playerRect, hiddenAreaRect)) {
                 // Do something special when the player finds the hidden area (optional)
                 console.log("You found the hidden area!");
                 // Maybe reveal a hint, give a power-up, etc.
            }

        }

           // Helper function to check if two rectangles overlap
         function rectsOverlap(rect1, rect2) {
             return !(rect1.right < rect2.left ||
                      rect1.left > rect2.right ||
                      rect1.bottom < rect2.top ||
                      rect1.top > rect2.bottom);
        }

          // --- Function to end the game ---
        function endGame(playerWins) {
            gameRunning = false;

              // Remove all obstacles
            for (const obstacle of obstacles) {
                 gameLevel.removeChild(obstacle.element);
             }
            obstacles = [];

             if (playerWins) {
                // Show "You Win" message
                winMessage.classList.add('show'); // Use the class for animation
                setTimeout(() => {
                    winMessage.classList.remove('show'); // Hide after a delay
                     resetGame();
                }, 5000); // 5 seconds

             } else {
                // Show "Game Over" message (optional)
                // alert("Game Over! You hit an obstacle."); // Or create a more stylish message
                 resetGame();
            }
              // Hide the game level
            gameLevel.style.display = 'none';
        }


         // --- Function to reset the game ---
        function resetGame() {
             // Hide game level and win message
            gameLevel.style.display = 'none';
            winMessage.classList.remove('show');
             // Reset any game state (player position, obstacles, etc.)

             // You might want to show the initial "inescapable" elements again here
            //  (e.g., the close button, floaters - but probably in a less intense way)
        }

        // --- Event Listeners ---
           // --- Key Down (for player movement) ---
         document.addEventListener('keydown', (event) => {
             if (!gameRunning) return; // Don't move if the game isn't active

              const speed = 10; // Player movement speed

            switch (event.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    playerY = Math.max(0, playerY - speed); // Prevent going off-screen (top)
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                     playerY = Math.min(window.innerHeight - player.offsetHeight, playerY + speed); // Prevent going off-screen (bottom)
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                      playerX = Math.max(0, playerX - speed); // Prevent going off-screen (left)
                     break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    playerX = Math.min(window.innerWidth - player.offsetWidth, playerX + speed); // Prevent going off-screen (right)
                    break;
                default:
                    return; // Ignore other keys
             }

             player.style.left = `${playerX}px`;
             player.style.top = `${playerY}px`;

            checkCollision(); // Check for collisions after each move
         });


        // ---  (Remove event listeners from the "inescapable" part that are no longer needed) ---
        // Example:
        // document.removeEventListener('contextmenu', preventDefaultHandler);

        // --- VERY IMPORTANT:  Find and adapt the old closeButton logic ---

        // Find the old closeButton event listener (from the previous response).
        // It should look something like this:
        //
        // closeButton.addEventListener('click', (event) => { ... });
        //
        //  You need to *replace* the contents of that event listener with
        //  logic to start the game.  For example:

        const closeButton = document.getElementById('close-button'); // Make sure this is defined
        if (closeButton) { // Check if closeButton actually exists
            closeButton.addEventListener('click', (event) => {
                event.stopPropagation();
                closeAttempt++;

                // ... (all the previous closeAttempt logic) ...
                if(closeAttempt >= 11){
                   startGame()
                }

            });
        }


        // --- Initial Setup (if needed) ---
        //  (You might want to initially hide the game level, etc.)
        // gameLevel.style.display = 'none';
    </script>
</body>

</html>
